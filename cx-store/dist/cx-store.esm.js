var t=function(t){return"function"==typeof t},e=function(t){return null!==t&&"[object Object]"===Object.prototype.toString.call(t)},r=function(t){return"_"+t+"_"},n=function(e,r){return r.reduce((function(e,r){return t(r)?r(e):e}),e)},o=function(t){return e(t)||Array.isArray(t)?(Object.entries(t).forEach((function(e){var r=e[0],n=e[1];try{var i=JSON.parse(n);Reflect.set(t,r,o(i))}catch(t){}})),t):t},i=function(){function o(t){if(this.onSet=[],this.onGet=[],!["session","local"].includes(t))throw new TypeError("can't init store with type: "+t);this.instance="session"===t?sessionStorage:localStorage}return o.prototype.set=function(t,e,o,i){void 0===o&&(o=99999999),void 0===i&&(i="global");var c=n(e,this.onSet);try{var s=this.getModule(i);return Reflect.set(s,t,{expire:1e3*o,val:c,time:Date.now()}),this.instance.setItem(r(i),JSON.stringify(s)),!0}catch(r){return console.error("failed to set storage: { key:"+t+",val:"+e+" }"),!1}},o.prototype.get=function(t,e){void 0===e&&(e="global");var r=this.getModule(e);try{var o=Reflect.get(r,t);if(!o)return;var i=o.time,c=o.expire,s=o.val;return+i+ +c<=Date.now()?void this.remove(t,e):n(s,this.onGet)}catch(e){return void console.error("failed to getItem with key : "+t)}},o.prototype.remove=function(t,e){void 0===e&&(e="global");try{var n=this.getModule(e);return Reflect.deleteProperty(n,t),this.instance.setItem(r(e),JSON.stringify(n)),!0}catch(t){return!1}},o.prototype.getModule=function(t){var e;try{return JSON.parse(null!==(e=this.instance.getItem(r(t)))&&void 0!==e?e:"{}")}catch(t){return{}}},o.prototype.use=function(r){if(e(r)){var n=r.onSet,o=r.onGet;t(n)&&this.onSet.push(n),t(o)&&this.onGet.push(o)}},o}(),c={onSet:function(t){if(e(t)){var r=(o=t,JSON.parse(JSON.stringify(o))),n=function(t){Object.entries(t).forEach((function(r){var o=r[0],i=r[1];null==i?Reflect.deleteProperty(t,o):e(i)&&n(i)}))};return n(r),r}var o;return t},onGet:o};export default i;export{c as storeFilter};
